%%{init: {'theme': 'base', 'themeVariables': { 'fontSize': '11px', 'fontFamily': 'arial', 'primaryColor': '#FFFFFF', 'primaryBorderColor': '#000000', 'lineColor': '#000000', 'tertiaryColor': '#F0F0F0', 'tertiaryTextColor': '#000000'}, 'flowchart': {'useMaxWidth': true, 'htmlLabels': true, 'curve': 'linear'}}}%%

flowchart TD
    
    %% IDENTIFICATION SECTION
    IDENT["<b>IDENTIFICATION</b>"]
    
    DB["<b>Records identified<br/>from databases</b><br/>n = 3,547"]
    REGISTER["<b>Records identified<br/>from other sources</b><br/>n = 245"]
    
    DB --> TOTAL["<b>Total records</b><br/>n = 3,792"]
    REGISTER --> TOTAL
    
    %% SCREENING SECTION
    SCREEN["<b>SCREENING</b>"]
    
    TOTAL --> DEDUP["<b>Records after<br/>duplicate removal</b><br/>n = 3,245"]
    
    DEDUP --> SCREENED["<b>Records screened</b><br/>n = 3,245"]
    DEDUP --> EXCLUDED_SCREEN["<b>Records excluded</b><br/>n = 2,847"]
    
    SCREENED --> SOUGHT["<b>Articles/reports<br/>sought for evaluation</b><br/>n = 398"]
    
    %% ELIGIBILITY SECTION  
    ELIGIBLE["<b>ELIGIBILITY</b>"]
    
    SOUGHT --> NOT_RETRIEVED["<b>Articles/reports<br/>not retrieved</b><br/>n = 45"]
    SOUGHT --> ASSESSED["<b>Articles/reports<br/>assessed for eligibility</b><br/>n = 353"]
    
    ASSESSED --> EXCLUDED_FULL["<b>Studies excluded<br/>with reasons</b><br/>n = 230"]
    
    EXCLUDED_FULL --> REASON1["Out of thematic scope<br/>(n = 145)"]
    EXCLUDED_FULL --> REASON2["No primary data<br/>(n = 52)"]
    EXCLUDED_FULL --> REASON3["Non-scientific articles<br/>(n = 33)"]
    
    %% INCLUSION SECTION
    INCLUDE["<b>INCLUSION</b>"]
    
    ASSESSED --> INCLUDED["<b>Studies included<br/>in qualitative synthesis</b><br/>n = 123"]
    
    INCLUDED --> SYNTHESIS["<b>Studies included in<br/>data synthesis</b><br/>n = 123"]
    
    SYNTHESIS --> OUTPUT["<b>FINAL SYNTHESIS</b><br/>Mapping of ML in GI<br/>Techniques, applications and impacts"]
    
    %% Posicionamento das seções
    IDENT -.-> DB
    SCREEN -.-> SCREENED
    ELIGIBLE -.-> ASSESSED
    INCLUDE -.-> SYNTHESIS
    
    %% Estilos - SEÇÕES
    style IDENT fill:#E8E8E8,stroke:#000,stroke-width:2px,color:#000,font-weight:bold,text-align:center
    style SCREEN fill:#E8E8E8,stroke:#000,stroke-width:2px,color:#000,font-weight:bold,text-align:center
    style ELIGIBLE fill:#E8E8E8,stroke:#000,stroke-width:2px,color:#000,font-weight:bold,text-align:center
    style INCLUDE fill:#E8E8E8,stroke:#000,stroke-width:2px,color:#000,font-weight:bold,text-align:center
    
    %% Estilos - CAIXAS BRANCAS (Processo/Resultado)
    style DB fill:#FFFFFF,stroke:#000,stroke-width:1.5px,color:#000
    style REGISTER fill:#FFFFFF,stroke:#000,stroke-width:1.5px,color:#000
    style TOTAL fill:#FFFFFF,stroke:#000,stroke-width:2px,color:#000,font-weight:bold
    
    style DEDUP fill:#FFFFFF,stroke:#000,stroke-width:1.5px,color:#000
    style SCREENED fill:#FFFFFF,stroke:#000,stroke-width:1.5px,color:#000
    style EXCLUDED_SCREEN fill:#F5F5F5,stroke:#999,stroke-width:1px,color:#333
    style SOUGHT fill:#FFFFFF,stroke:#000,stroke-width:1.5px,color:#000
    
    style NOT_RETRIEVED fill:#F5F5F5,stroke:#999,stroke-width:1px,color:#333
    style ASSESSED fill:#FFFFFF,stroke:#000,stroke-width:1.5px,color:#000
    style EXCLUDED_FULL fill:#F5F5F5,stroke:#999,stroke-width:1px,color:#333
    
    style REASON1 fill:#FFFACD,stroke:#DAA520,stroke-width:0.8px,color:#333,font-size:9px
    style REASON2 fill:#FFFACD,stroke:#DAA520,stroke-width:0.8px,color:#333,font-size:9px
    style REASON3 fill:#FFFACD,stroke:#DAA520,stroke-width:0.8px,color:#333,font-size:9px
    
    style INCLUDED fill:#FFFFFF,stroke:#000,stroke-width:2px,color:#000,font-weight:bold
    style SYNTHESIS fill:#FFFFFF,stroke:#000,stroke-width:2px,color:#000,font-weight:bold
    style OUTPUT fill:#90EE90,stroke:#228B22,stroke-width:2px,color:#000,font-weight:bold